(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{429:function(t,n,e){"use strict";e.r(n);var i=e(10),l=Object(i.a)({},(function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"quilleditor-图片-视频上传功能及大小链接设置"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#quilleditor-图片-视频上传功能及大小链接设置"}},[t._v("#")]),t._v(" quillEditor 图片/视频上传功能及大小链接设置")]),t._v(" "),e("p",[e("img",{attrs:{src:"Public/upload/2020-11-13/202011131025565621.png",alt:"5fadeeb07837b.png"}})]),t._v(" "),e("p",[t._v("Editor.vue")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("<template>\n\t<div ref=\"cn\" class=\"editor\" @mousemove=\"mousemove($event)\">\n\n\t\t<quill-editor  :ref=\"id\" placeholder=\"请输入停车场使用规范\" v-model=\"editorContent\" :options=\"editorOption_cn\" @change=\"change\">\n\t\t\t\t</quill-editor>\n\n\t\t\t\t\x3c!-- 中文插入图片 --\x3e\n\t\t<VueQuillUpload\n\t\t:class=\"id\"\n\t\tstyle=\"display: none\"\n\t\tv-bind:quill-updateImg.sync=\"quillUpdateImg_cn\"\n\t\tv-bind:editor-quill.sync = \"quill_cn\"\n\t\t></VueQuillUpload>\n\n\n\t\t<VueQuillUploadVideo\n\t\tv-bind:is-show.sync=\"VueQuillUploadVideoVisible\" \n\t\tv-bind:editor-quill.sync = \"quill_cn\"\n\n\t\t></VueQuillUploadVideo>\n\n\t\t<ImgTip \n\t\tv-bind:position-left=\"positionLeft\"\n\t\tv-bind:position-top=\"positionTop\"\n\t\tv-bind:img-obj=\"imgOrIframe\"\n\t\tv-bind:editor-content.sync=\"editorContent\"\n\t\tv-bind:editor-quill.sync = \"quill_cn\"\n\n\t\t></ImgTip>\n\t</div>\n</template>\n<script>\n\timport VueQuillUpload from './VueQuillUpload.vue';\n\timport VueQuillUploadVideo from './VueQuillUploadVideo.vue';\n\timport ImgTip from './ImgTip.vue';\n\n\n\n\n\timport { quillEditor } from 'vue-quill-editor'\n// import Quill from 'quill'  // 引入编辑器\n// \timport ImageResize from 'quill-image-resize-module';\n//  Quill.register('modules/imageResize',ImageResize)\n\n\n\timport 'quill/dist/quill.core.css'\n\timport 'quill/dist/quill.snow.css'\n\timport 'quill/dist/quill.bubble.css'\n\n\texport default{\n\t\tcomponents:{\n\t\t\tquillEditor,\n\t\t\tVueQuillUpload,\n\t\t\tVueQuillUploadVideo,\n\t\t\tImgTip\n\t\t},\n\t\tprops:['editorContent'],\n\t\tdata(){\n\t\t\treturn {\n\t\t\t\tquillUpdateImg_cn:false,\n\t\t\t\timgOrIframe:null,\n\t\t\t\tquill_cn:{},\n\t\t\t\teditorOption_cn: { \n\t\t\t\t\tplaceholder: '请输入内容',\n\t\t\t\t     modules: {\n\t\t\t\t      toolbar: \n\n\t\t\t\t       {\n                            container: [// 工具栏\n\t\t\t\t\t\t        ['bold', 'italic', 'underline', 'strike','link','image','video'],\n\t\t\t\t\t\t        // ['blockquote'],\n\t\t\t\t\t\t        [{ 'list': 'ordered' }, { 'list': 'bullet' }],\n\t\t\t\t\t\t        // [{ 'script': 'sub' }, { 'script': 'super' }],\n\t\t\t\t\t\t        [{ 'indent': '-1' }, { 'indent': '+1' }],\n\t\t\t\t\t\t        [{ 'size': ['small', false, 'large', 'huge'] }],\n\t\t\t\t\t\t        [{ 'color': [] }, { 'background': [] }],\n\t\t\t\t\t\t        // ['clean'],\n\t\t\t\t\t\t        [{ 'align': [] }],  \n\t\t\t\t\t\t        ['fullscreen'] \n\n\n\t\t\t\t\t\t      ],\n\n                            handlers: {\n                                'image': function (value) {\n                                    if (value) {\n\n                                    \t// VueQuillUpload组件\n                                    \tdocument.querySelector('.'+this.id+' .avatar-uploader input').click()\n                                        // document.querySelector('#quill-upload input').click()\n                                    } else {\n                                        this.quill.format('image', false);\n                                    }\n                                },\n                                'video': (value)=> {\n                                \tif(value){\n\n\t\t                              \tthis.VueQuillUploadVideoVisible = true;\n\n                                \t}else{\n                                        this.quill.format('video', false);\n\n\n                                \t}\n\t                            }\n                            }\n                        },\n                        // imageResize:{\n                        //     displayStyles:{\n                        //         backgroundColor:'black',\n                        //         border:'none',\n                        //         color:'white'\n                        //     },\n                        //     modules:['Resize','DisplaySize','Toolbar']\n                        // }\n\t\t\t\t\t }\n\t\t\t\t},\n\t\t\t\tVueQuillUploadVideoVisible:false,\n\t\t\t\tImgTipVisible:false,\n\t\t\t\tpositionLeft:0,\n\t\t\t\tpositionTop:0,\n\t\t\t\tcontent:''\n\t\t\t}\n\t\t},\n\t\tmethods:{ \n\n\t\t\tchange:function(){ \n\t\t\t\tthis.$nextTick(()=>{\n\n\t\t\t\t\tthis.$emit('update:editorContent',this.editorContent);\n\n\t\t\t\t})\n\t\t\t},\n\t\t\tgetElementLeft: function(element,className){\n\t\t\t　　　　var actualLeft = element.offsetLeft;\n\t\t\t　　　　var current = element.offsetParent;\n\n\t\t\t　　　　while (current !== null){\n\t\t\t　　　　　　actualLeft += current.offsetLeft;\n\t\t\t　　　　　　current = current.offsetParent;\n\n\t\t\t\t\t if(current.className != className){\n\t\t\t\t\t\t  \tbreak;\n\t\t\t\t\t\t  }\n\t\t\t　　　　}\n\n\t\t\t　　　　return actualLeft;\n\t\t\t},\n\t\t\tgetElementTop:function(element,className){\n\n\t\t　　　　var actualTop = element.offsetTop;\n\t\t　　　　var current = element.offsetParent;\n\n\t\t　　　　while (current !== null){ \n\n\t\t　　　　　　actualTop += current.offsetTop;\n\t\t　　　　　　current = current.offsetParent;\n\n\t\t\t\t  if(current.className != className){\n\t\t\t\t  \tbreak;\n\t\t\t\t  }\n\n\t\t　　　　}\n\n\t\t　　　　return actualTop;\n\t\t　　},\n\t\t\t//生成图片设置工具\n\t\t\tcreateHandler:function(){\n\t\t\t\t// console.log(scrollTop)\n\n\t\t\t\t//计算图片this.imgOrIframe距 editor的距离  \n\n\t\t\t\tif(this.imgOrIframe !==  null){\n\t\t\t\t\tthis.positionLeft =  this.getElementLeft(this.imgOrIframe,'editor');\n\t\t\t\t\tthis.positionTop =  this.getElementTop(this.imgOrIframe,'editor')-document.getElementsByClassName('ql-editor')[0].scrollTop;\n\t\t\t\t\t \n\n\t\t\t\t}else{\n\t\t\t\t\tthis.ImgTipVisible = false\n\t\t\t\t}\n \n\n\n\t\t\t},\n\t\t\tmousemove:function(event){\n \n\t\t\t\tif(this.imgOrIframe === null){\n\t\t\t\t\t\tif(event.target.tagName.toLowerCase() == 'img' || \n\t\t\t\t\t\t\tevent.target.tagName.toLowerCase() == 'iframe' ){\n \n\t\t\t\t\t\t\tconsole.log('图片或iframe');\n\t\t\t\t\t\t\tthis.imgOrIframe = event.target;\n\t\t\t\t\t\t\t// this.createHandler();\n\n\n\t\t\t\t\t\t}\n\t\t\t\t}else if(\n\t\t\t\t\t(event.target.tagName.toLowerCase() == 'img' || \n\t\t\t\t\tevent.target.tagName.toLowerCase() == 'iframe') && \n\t\t\t\t\tthis.imgOrIframe.getAttribute('src') != event.target.src){\n\n\t\t\t\t\tthis.imgOrIframe = event.target;\n\t\t\t\t\tconsole.log('换图或iframe了');\n\t\t\t\t\t// this.createHandler();\n\n\t\t\t\t}\n\n\t\t\t\tthis.$nextTick(this.createHandler) \n\n\n\n\t\t\t}\n\t\t},\n\t\tmounted(){\n\n\t\t\tthis.quill_cn = this.$refs[this.id].quill;\n\n\t\t\tthis.$nextTick(()=>{\n\n\t\t\t\tthis.quill_cn.container.firstChild.onscroll = ()=>{\n\t\t\t\t\tthis.imgOrIframe = null;\n\t\t\t\t}\n\n\t\t\t})\n\n\t\t},\n\t\tcreated(){\n\n\t\t},\n\t\tcomputed:{\n\n\t\t},\n\t\twatch:{ \n\n\t\t}\n\t}\n\n<\/script>\n<style scoped>\n\t.editor{\n\t\tposition:relative;\n\t\tpadding-bottom: 60px;\n\t\toverflow: hidden;\n\t}\n</style>\n<style>\n\n\t.editor .ql-toolbar.ql-snow{\n\t\tborder: 1px solid #DCDFE6;\n\t\tborder-top-left-radius: 4px;\n\t\tborder-top-right-radius: 4px;\n\n\t}\n\t.editor .ql-container.ql-snow{\n\t\tborder: 1px solid #DCDFE6;\n\t\tborder-bottom-left-radius: 4px;\n\t\tborder-bottom-right-radius: 4px;\n\t}\n\t.editor .ql-editor.ql-blank::before {\n\t    color: rgba(165, 160, 160, 0.6);\n\t    content: attr(data-placeholder);\n\t    font-style: normal;\n\t    left: 15px;\n\t    pointer-events: none;\n\t    position: absolute;\n\t    right: 15px;\n\t}\n\t.editor .quill-editor{\n\t\theight: 400px; \n\t}\n\t.editor .ql-editor p{\n\t\tmargin-bottom: 10px;\n\t}\n\t.editor .ql-editor .ql-video{\n\t/*\twidth: 660px;\n\t\theight: 508px;*/\n\t\tmargin:0 auto;\n\t\toverflow: hidden;\n\t}\n</style>\n\n")])])]),e("p",[t._v("VueQuillUpload.vue")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v('<template>\n\t<div>\n\t\t<el-upload ref="upload"\n                class="avatar-uploader"\n                action="/admin/file/uploadFile?module=dc_video"\n\t\t\t\tlimit="1" \n\t\t\t\t:auto-upload="true" \n                name="file"\n                :headers="header"\n                :show-file-list="false"\n                :on-success="uploadSuccess"\n                :on-error="uploadError"\n                :before-upload="beforeUpload"\n                accept="image/png,image/jpeg,image/gif">\n        </el-upload>\n\t</div>\n</template>\n<script>\n\texport default{\n\t\tprops:[\'editorQuill\',\'quillUpdateImg\'],\n\t\tdata(){\n\t\t\treturn {\n\n\t\t\t}\n\t\t},\n\t\tmethods:{\n\t\t\t// 富文本图片上传前\n            beforeUpload() {\n                // 显示loading动画\n                this.quillUpdateImg = true\n            },\n  \n            uploadSuccess(res, file) {\n                // res为图片服务器返回的数据\n                // 获取富文本组件实例\n                // let quill = this.$refs.myQuillEditor.quill; \n  \n                let quill = this.editorQuill;\n\n                // 如果上传成功\n                if (res.code === \'00\') {\n                    // 获取光标所在位置\n                    let length = quill.getSelection().index;\n                    // 插入图片  res.info为服务器返回的图片地址\n                    // quill.insertEmbed(length, \'image\', res.info)\n                    quill.insertEmbed(length, \'image\', res.obj)\n\n\n                    // 调整光标到最后\n                    quill.setSelection(length + 1)\n\n                    this.$refs.upload.clearFiles();\n\n\n\n                } else {\n                    this.$message.error(\'图片插入失败\')\n                }\n                // loading动画消失\n                this.quillUpdateImg = false\n            },\n   \n            // 富文本图片上传失败\n            uploadError() {\n                // loading动画消失\n                this.quillUpdateImg = false\n                this.$message.error(\'图片插入失败\')\n            }\n\t\t}\n\t}\n<\/script>\n')])])]),e("p",[t._v("VueQuillUploadVideo.vue")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v('<template>\n\t<div>\n\t\t<el-dialog\n\t\t    title="视频上传"\n\t\t    :visible.sync="show"\n\t\t    width="30%"\n\t\t    @close="close">\n\n\t\t    <el-form :model="form" :rules="formRules" ref="form" class="p-t-10">\n\t\t        <el-form-item label="" prop="url" class="p-b-10">\n\t\t            <el-input size="small" v-model="form.url" placeholder="请输入视频地址">\n\t\t  \n\t\t            \t<template slot="append">\n\t\t            \t\t<el-upload ref="upload"\n\t\t\t\t\t\t\t\taction="/admin/file/uploadVideoFile?module=dc_video"\n\t\t\t\t\t\t\t\taccept=".mov,.mp4,.m4a,.3gp,.3g2"\n\t\t\t\t\t\t\t\t:show-file-list="false"\n\t\t\t\t\t\t\t\t:on-success="handleVideoSuccess"\n\t\t\t\t\t\t\t\t:before-upload="handleBeforeUpload"\n\t\t\t\t\t\t\t\t:on-error="handleUploadError"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<el-button size="small" type="primary" icon="el-icon-upload2" :loading="upLoaidng">上传视频</el-button>\n\t\t\t\t\t\t\t</el-upload>\n\t\t            \t</template>\n\t\t            </el-input>\n\t\t        </el-form-item>\n\t\t        <el-form-item>\n\t\t            <el-button size="small" @click="close">取消</el-button>\n\t\t            <el-button size="small" type="primary" @click="onSubmit">提交</el-button>\n\t\t        </el-form-item>\n\t\t    </el-form>\n\t\t</el-dialog>\n\t</div>\n</template>\n<script>\n\texport default{\n\t\tcomponents:{},\n\t\tprops:[\'editorQuill\',\'isShow\'],\n\t\tdata(){\n\t\t\treturn {\n\t\t\t\tshow:false,\n\t\t\t\tform:{\n\t\t\t\t\turl:\'\'\n\t\t\t\t},\n\t\t\t\tformRules:{\n\t\t\t\t\turl:[\n\t\t\t\t\t\t{ required: true, message: \'请输入视频地址或上传视频！\', trigger: \'blur\' },\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\tupLoaidng:false\n\t\t\t}\n\t\t},\n\t\tmethods:{\n\t\t\tclose:function(){\n\t\t\t\tthis.$emit(\'update:isShow\',false);\n\t\t\t},\n\t\t\thandleBeforeUpload() {\n\t\t\t\tthis.upLoaidng = true;\n\t\t\t\treturn true;\n\t\t\t},\n\t\t\thandleVideoSuccess(res, file) {\n\t\t\t\tthis.upLoaidng = false;\n\t\t\t\tlet { code, msg, obj } = res;\n\t\t\t\tif (code == \'00\') {\n\t\t\t\t\tlet urls = obj.split(\'#\');\n\t\t\t\t\tthis.form.url = urls[0]; \n\t\t\t\t\tthis.$message({\n\t\t\t\t\t\ttype: \'success\',\n\t\t\t\t\t\tmessage: \'上传成功\',\n\t\t\t\t\t});\n\n\n\t\t\t\t\tthis.$nextTick(()=>{\n\t\t\t\t\t\tthis.$refs.form.validateField(\'url\');\n\t\t\t\t\t}) \n\n\n\t\t\t\t} else {\n\t\t\t\t\tthis.$message({\n\t\t\t\t\t\ttype: \'warning\',\n\t\t\t\t\t\tmessage: msg,\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t},\n\t\t\tinsertVideo:function(url){\n\t\t\t\tlet quill = this.editorQuill;\n\t\t\t\tconsole.log(quill);\n                console.log(quill.getSelection());\n\n                console.log(quill.selection.savedRange.index);\n \n                // 获取光标所在位置 \n               let length = quill.getSelection() !==null? quill.getSelection().index: quill.selection.savedRange.index\n\n                // 插入图片  res.info为服务器返回的图片地址\n                // quill.insertEmbed(length, \'image\', res.info)\n                quill.insertEmbed(length, \'video\', url);\n\n\n                // 调整光标到最后\n                quill.setSelection(length + 1)\n\n                this.$refs.upload.clearFiles();\n\n \n\n\t\t\t},\n\t\t\tonSubmit:function(){\n\n\t\t\t\tthis.$refs.form.validate(valid=>{\n\n\t\t\t\t\tif(valid){\n\n\t\t\t\t\t\t// this.callBack && this.callBack(this.form.url);\n\n\t\t\t\t\t\tthis.insertVideo(this.form.url);\n\n\t\t\t\t\t\tthis.form.url = \'\';\n\n\t\t\t\t\t\tthis.$nextTick(()=>{\n\n\t\t\t\t\t\t\tthis.close();\n\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\n\t\t\t\t})\n\t\t\t}\n\t\t},\n\t\tmounted(){ \n\t\t},\n\t\tcreated(){\n\n\t\t},\n\t\tcomputed:{\n\n\t\t},\n\t\twatch:{\n\t\t\t\'isShow\':function(v){\n\t\t\t\tthis.show = v;\n\t\t\t}\n\t\t}\n\t}\n\n<\/script>\n<style scoped>\n\n</style>\n')])])]),e("p",[t._v("ImgTip.vue")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("<template>\n\t<div>\n\t\t<i class=\"el-icon-setting tip\" @click=\"openSetting\" title=\"设置\" \n\t\tv-if=\"imgObj!== null && positionTop>30\"\n\t\tv-bind:style=\"{\n\t\t\t'left':positionLeft+10+'px',\n\t\t\t'top':positionTop+10+'px'\n\t\t}\"\n\t\t></i>\n\n\n\t\t<el-dialog\n\t\t    title=\"设置\"\n\t\t    :visible.sync=\"show\"\n\t\t    width=\"30%\"\n\t\t    @close=\"close\" :append-to-body=\"true\">\n\t\t    <el-form :model=\"form\" :rules=\"formRules\" ref=\"form\" label-width=\"100px\" class=\"p-t-0\">\n\t\t    \t <el-tabs v-model=\"activeName\"  class=\"p-t-0 p-l-10 p-r-10\">\n\t\t\t\t    <el-tab-pane label=\"尺寸\" name=\"first\">\n\t\t\t\t\t      <el-row :gutter=\"0\">\n\t\t\t            <el-col :span=\"12\" class=\"padding\">\n\t\t\t\t\t        <el-form-item label=\"宽：\" prop=\"width\">\n\t\t\t\t\t\t\t\t<el-input size=\"small\" v-model=\"form.width\" placeholder=\"\" @input=\"wInput\"></el-input>\n\t\t\t\t\t        </el-form-item>\n\t\t\t       \n\t\t\t            </el-col>\n\t\t\t            <el-col :span=\"12\"  class=\"padding\">\n\t\t\t                 <el-form-item label=\"高：\" prop=\"height\">\n\t\t\t\t\t\t\t\t<el-input size=\"small\" v-model=\"form.height\" placeholder=\"\"  @input=\"hInput\"></el-input>\n\t\t\t\t\t        </el-form-item>\n\t\t\t            </el-col>\n\t\t\t        </el-row>\n\n\t\t\t\t    </el-tab-pane>\n\t\t\t\t    <el-tab-pane label=\"链接\" name=\"second\"  :disabled=\"type=='iframe'\">\n\t\t\t\t    \t<el-row :gutter=\"0\">\n\t\t\t            \t<el-col :span=\"24\" >\n\n\t\t\t\t    \t <el-form-item label=\"链接地址：\" prop=\"link\">\n\t\t\t\t\t\t\t\t<el-input size=\"small\" v-model=\"form.link\" placeholder=\"\"></el-input>\n\t\t\t\t\t        </el-form-item>\n\t\t\t\t\t    </el-col>\n\t\t\t\t            <el-col :span=\"24\" >\n\n\t\t\t\t\t        <el-form-item label=\"打开方式：\" prop=\"target\">\n\t\t\t\t\t\t\t\t<el-select size=\"small\" v-model=\"form.target\" placeholder=\"\">\n\t\t\t\t\t\t\t\t    <el-option v-for=\"item in targetList\"\n\t\t\t\t\t\t\t\t        :key=\"item.value\"\n\t\t\t\t\t\t\t\t        :label=\"item.label\"\n\t\t\t\t\t\t\t\t        :value=\"item.value\">\n\t\t\t\t\t\t\t\t    </el-option>\n\t\t\t\t\t\t\t\t</el-select>\n\t\t\t\t\t        </el-form-item>\n\t\t\t\t\t    </el-col>\n\t\t\t\t\t</el-row>\n\t\t\t\t    </el-tab-pane> \n\t\t\t\t  </el-tabs>\n\t\t  \n\t\t        <el-form-item>\n\t\t            <el-button size=\"small\" @click=\"close\">取消</el-button>\n\t\t            <el-button size=\"small\" type=\"primary\" @click=\"onSubmit\">修改</el-button>\n\t\t        </el-form-item>\n\t\t    </el-form>\n\t\t</el-dialog>\n\t</div>\n</template>\n<script>\n\texport default{\n\t\tcomponents:{},\n\t\tprops:['positionLeft','positionTop','imgObj','editorContent','editorQuill'],\n\t\tdata(){\n\t\t\treturn {\n\t\t\t\taimObj:null,\n\t\t\t\tshow:false,\n\t\t\t\tform:{\n\t\t\t\t\twidth:0,\n\t\t\t\t\theight:0,\n\t\t\t\t\tlink:'',\n\t\t\t\t},\n\t\t\t\tformRules:{\n\t\t\t\t\twidth:[\n\t\t\t\t\t\t{ required: true, message: '请图片宽度', trigger: 'blur' },\n\t\t\t\t\t],\n\t\t\t\t\theight:[\n\t\t\t\t\t\t{ required: true, message: '请图片高度', trigger: 'blur' },\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\trate:1,\n\n\t\t\t\ttargetList:[\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel:'当前页',\n\t\t\t\t\t\tvalue:'_self'\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel:'新页打开',\n\t\t\t\t\t\tvalue:'_blank'\n\t\t\n\t\t\t\t\t}\n\t\t\t\t],\n\t\t\t\tactiveName:'first',\n\t\t\t\ttype:'img'\n\t\t\t}\n\t\t},\n\t\tmethods:{\n\t\t\twInput:function(){\n\t\t\t\tthis.$nextTick(()=>{\n\n\t\t\t\t\tif(this.form.width.replace(/ /g,'') == ''){\n\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\n\t\t\t\tif(this.imgObj.tagName.toLowerCase() == 'img'){\n\t\t\t\t\t\tthis.form = {\n\t\t\t\t\t\t\t...this.form,\n\t\t\t\t\t\t\t...{\n\t\t\t\t\t\t\t\twidth:this.form.width.replace(/[^\\d]/g,''),\n\t\t\t\t\t\t\t\theight:parseInt(this.form.width.replace(/[^\\d]/g,'')*1/this.rate)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t}\n\n\n\t\t\t\n\n\t\t\t\t})\n\t\t\t},\n\t\t\thInput:function(){\n\t\t\t\tthis.$nextTick(()=>{\n\n\t\t\t\t\tif(this.form.height.replace(/ /g,'') == ''){\n\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\n\t\t\t\tif(this.imgObj.tagName.toLowerCase() == 'img'){\n\n\t\t\t\t\tthis.form = {\n\t\t\t\t\t\t...this.form,\n\t\t\t\t\t\t...{\n\t\t\t\t\t\t\twidth:parseInt(this.form.height.replace(/[^\\d]/g,'')*1*this.rate),\n\t\t\t\t\t\t\theight:this.form.height.replace(/[^\\d]/g,'')\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t})\n\t\t\t},\n\n\n\t\t\topenSetting:function(){ \n\n\t\t\t\tif(this.imgObj == null){\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\n\t\t\t\tif(this.imgObj.tagName.toLowerCase() == 'iframe'){\n\n\t\t\t\t\tvar h = this.imgObj.offsetHeight\n\t\t\t\t\tvar w = this.imgObj.offsetWidth;\n\t\t\t\t}else{\n\n\t\t\t\t\tvar w = this.imgObj.width;\n\t\t\t\t\tvar h = this.imgObj.height;\n\t\t\t\t}\n\t\t\t\t \n\n\t\t\t\tthis.rate = w/h;\n \n\n\t\t\t\tthis.form = {\n\t\t\t\t\t...this.form,\n\t\t\t\t\t...{\n\n\t\t\t\t\t\twidth:w,\n\t\t\t\t\t\theight:h\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tthis.show = true\n\n\t\t\t},\n\t\t\tclose:function(){\n\t\t\t\tthis.show = false;\n\t\t\t},\n\t\t\tonSubmit:function(){\n\n\t\t\t\tthis.$refs.form.validate(valid=>{\n\n\t\t\t\t\tif(valid){\n \n\n\t\t\t\t\t\t// this.imgObj.style.width = this.form.width+'px';\n\t\t\t\t\t\t// this.imgObj.style.height = this.form.height+'px';\n\n\t\t\t\t\t\t(this.type =='iframe') && (_=>{\n\n\t\t\t\t\t\t\tthis.imgObj.setAttribute('width',this.form.width*1);\n\t\t\t\t\t\t\tthis.imgObj.setAttribute('height',this.form.height*1);\n\t\t\t\t\t\t})()\n\n\t\t\t\t\t\t(this.type =='img') && \n\t\t\t\t\t\tthis.imgObj.setAttribute('width',this.form.width);\n\t\t\t\t\t\t// this.imgObj.setAttribute('height',this.form.height);\n\n\t\t\t\t\t\t(this.type =='img') && \n\t\t\t\t\t\tthis.createAParent();\n\n\t\t\t\t\t\t// console.log(this.editorQuill.getContents());\n\t\t\t\t\t\tthis.$emit('update:editorContent',this.editorQuill.container.firstChild.innerHTML);\n\n\t\t\t\t\t\tthis.close();\n\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t},\n\t\t\t domToString:function(node) {  \n\t\t\t     let tmpNode = document.createElement('div')\n\t\t\t     tmpNode.appendChild(node) \n\t\t\t     let str = tmpNode.innerHTML\n\t\t\t     tmpNode = node = null; // 解除引用，以便于垃圾回收  \n\t\t\t     return str;  \n\t\t\t},\n\t\t\tcreateAParent:function(){\n\t\t\t\tvar parent = this.imgObj.parentNode;\n\n\t\t\t\tif(this.form.link.replace(/ /g,'') !=''){\n\t\t\t\t   if(parent.tagName.toLowerCase() == 'a'){ //有链接\n\t\t\t\t   \t\tparent.setAttribute('href',this.form.link);\n\t\t\t\t   \t\tparent.setAttribute('target',this.form.target);\n\n\t\t\t\t\t}else{\n\n\t\t\t\t\t//如果没有a 则创建\n\t\t\t\t\tconsole.log('如果没有a 则创建'); \n\n\t\t\t\t\tvar a = document.createElement('a');\n\t\t\t        a.href=this.form.link;\n\t\t\t        a.target = this.form.target==''?'_self':this.form.target;\n\t\t\t        this.imgObj.parentNode.replaceChild(a,this.imgObj);\n\t\t\t        a.appendChild(this.imgObj);\n\n\n\t\t\t\t\t}\n\t\n\t\t\t\t}else{\n\n\t\t\t\t   if(parent.tagName.toLowerCase() == 'a'){ //有链接\n\n\t\t\t\t\t//清掉父 a标签 \n\t\t\t\t\tthis.imgObj.parentNode.parentNode.insertBefore(this.imgObj.cloneNode(true),this.imgObj.parentNode);\n\t\t\t\t    this.imgObj.parentNode.parentNode.removeChild(this.imgObj.parentNode);\n\n\t\t\t\t   }\n\n\t\n\n\t\t\t\t}\n\t\t\t},\n\t\t\tgetUrlOfImg:function(){ \n\t\t\t   var parent = this.imgObj.parentNode;\n\n\t\t\t   if(parent.tagName.toLowerCase() == 'a'){ //有链接\n\t\t\t   \t\tthis.form = {\n\t\t\t   \t\t\t...this.form,\n\t\t\t   \t\t\t...{\n\t\t\t   \t\t\t\tlink: parent.getAttribute('href'),\n\t\t\t   \t\t\t\ttarget:parent.getAttribute('target')?parent.getAttribute('target'):'_self'\n\t\t\t   \t\t\t}\n\t\t\t   \t\t};\n\n\t\t\t   }else{\n\n\t\t\t   \tthis.form = {\n\t\t\t   \t\t...this.form,\n\t\t\t   \t\t...{\n\t\t\t   \t\t\tlink:'',\n\t\t\t   \t\t\ttarget:''\n\t\t\t   \t\t}\n\t\t\t   \t}\n\t\t\t   }\n\n\t\t\t}\n\n\t\t},\n\t\tmounted(){\n\n\t\t},\n\t\tcreated(){\n\n\t\t},\n\t\tcomputed:{\n\n\t\t},\n\t\twatch:{\n\t\t\t'show':function(v){\n\t\t\t\tif(v){ \n\t\t\t\t\tthis.activeName = 'first';\n\t\t\t\t\tthis.getUrlOfImg();\n\t\t\t\t\tif(this.imgObj.tagName.toLowerCase() == 'img'){\n\t\t\t\t\t\tthis.type ='img'\n\t\t\t\t\t}else{\n\t\t\t\t\t\tthis.type ='iframe';\n\t\t\t\t\t}\n \n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n<\/script>\n<style scoped>\n\t.tip{\n\t\tposition: absolute; \n\t\tcolor:#E6A23C;\n\t\tfont-size: 20px;\n\t\tfont-weight: bold;\n\t\tcursor: pointer;\n\t}\n\n</style>\n\n")])])]),e("backTop")],1)}),[],!1,null,null,null);n.default=l.exports}}]);