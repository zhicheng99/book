(window.webpackJsonp=window.webpackJsonp||[]).push([[76],{358:function(t,n,e){"use strict";e.r(n);var r=e(10),a=Object(r.a)({},(function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"使用-scp2-自动布署-vue-编译包到服务器"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#使用-scp2-自动布署-vue-编译包到服务器"}},[t._v("#")]),t._v(" 使用 scp2 自动布署 vue 编译包到服务器")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("//安装\nnpm install scp2 --save-dev\n\n//修改config/pro.env.js 增加TYPE字段\nlet type = process.argv.splice(2)[0] || '';\nmodule.exports = {\n  // NODE_ENV: '\"production\"',\n    NODE_ENV: '\"development\"' ,//为了发布后请求模拟数据，进行本地测试 ，  暂时改成 开发模式标识\n    TYPE:type,\n}\n")])])]),e("blockquote",[e("p",[t._v("修改 build.js")])]),t._v(" "),e("p",[e("img",{attrs:{src:"Public/upload/2020-02-10/5e40e137a7e16.png",alt:"",title:"5e40e137a7e16.png"}})]),t._v(" "),e("p",[t._v("auto-upload.js")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("//---------npm run build -- 60 命令自动布署\nmodule.exports = function(type){\n\t// let type = config.build.env.TYPE;\n\tlet client = require('scp2');\n\tlet chalk = require('chalk');\n \n\tvar mkdirp = require('mkdirp');\n\tvar copydirectory = require('copydirectory');\n\tvar rm = require('rimraf')\n\n\n\n\tlet delTemp = function(){\n\n\n\t\trm('./autoUpload',(err)=>{\n\t\t\tif (err){\n\t\t    \tconsole.log(chalk.cyan('  删除临时文件夹失败\\n'));\n\t\t    \treturn false;\n\t\t    }\n\t\t    console.log(chalk.cyan('  删除临时文件夹成功\\n'));\n\n\n\t\t})\n\n\t}\n  \n\tmkdirp('./autoUpload', function (err) {\n\n\n\t    if (err){\n\t    \tconsole.log(chalk.cyan('  创建临时文件夹失败\\n'));\n\t    \treturn false;\n\t    }\n\n\t\t copydirectory('./dist', './autoUpload', (error) => {\n\t\t  \tconsole.log(chalk.cyan('  copy文件成功\\n'));\n\n\t\t  \trm('./autoUpload/*.zip',(err)=>{\n\n\t\t  \t\tif(err){\n\t\t  \t\t\tconsole.log(chalk.cyan('  删除zip文件失败\\n'));\n\t\t  \t\t\treturn false;\n\t\t  \t\t}\n\n\n\t\t  \t\t switch(type){ \n\t\t\t\t\tcase '183':\n\t\t\t\t\t\tconsole.log(chalk.cyan('  正在上传文件到'+type+'服务器....\\n'));\n\t\t\t\t\t\t//自动上传服务器\n\t\t\t\t\t\tclient.scp('/Users/zhicheng/Documents/toutiao_99case_front/autoUpload/', {\n\t\t\t\t\t\t\thost: '47.105.36.183',\n\t\t\t\t\t\t\tusername: 'root',\n\t\t\t\t\t\t\tpassword: '密码',\n\t\t\t\t\t\t\tpath: '/usr/local/99case/html'\n\t\t\t\t\t\t}, function (err) {\n\t\t\t\t\t\t\tif (err) {\n\t\t\t\t\t\t\t\tconsole.log(err)\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tdelTemp();\n\n\t\t\t\t\t\t\t\tconsole.log(chalk.cyan('  文件上传完毕，布署完成!\\n'))\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\n\t\t\t\t\tbreak; \n\n\t\t\t\t}\n\n\n\n\n\n\t\t  \t})\n\n\t\t  })\n\n\t  \n\t});\n \n\n\t \n}\n\n")])])]),e("backTop")],1)}),[],!1,null,null,null);n.default=a.exports}}]);